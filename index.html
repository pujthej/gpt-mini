<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Mini Chat</title>
    <style>
      :root { font-family: system-ui, sans-serif; }
      body { margin: 0; display: grid; place-items: center; min-height: 100dvh; background:#f7f7f8; }
      .card { width: min(800px, 92vw); background: white; border: 1px solid #e6e6e6; border-radius: 12px; padding: 20px; box-shadow: 0 4px 20px rgba(0,0,0,.04); }
      h1 { margin: 0 0 16px; font-size: 20px; }
      form { display: flex; gap: 8px; }
      textarea { flex: 1; resize: vertical; min-height: 80px; padding: 12px; border-radius: 10px; border: 1px solid #ddd; outline: none; }
      button { padding: 12px 16px; border: 0; border-radius: 10px; cursor: pointer; }
      button[type=submit] { background: black; color: white; }
      .out { white-space: pre-wrap; border: 1px solid #eee; background:#fafafa; border-radius: 10px; padding: 12px; min-height: 80px; }
      .row { display: grid; gap: 6px; margin-top: 14px; }
      .muted { color: #666; font-size: 12px; }
    </style>
  </head>
  <body>
    <div class="card">
      <h1>Mini Chat</h1>
      <form id="chat-form">
        <textarea id="input" placeholder="Ask me anything…"></textarea>
        <button type="submit">Send</button>
      </form>

      <div class="row">
        <div class="muted">Assistant reply</div>
        <div id="output" class="out"></div>
      </div>
    </div>

    <script>
      const form = document.getElementById('chat-form');
      const input = document.getElementById('input');
      const output = document.getElementById('output');

      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        const message = input.value.trim();
        if (!message) return;

        output.textContent = "Thinking…";
        try {
          const res = await fetch('/api/chat', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ message })
          });
          const data = await res.json();
          output.textContent = data.reply ?? (data.error || "No reply");
        } catch (err) {
          output.textContent = "Error: " + err.message;
        }
      });
    </script>
  </body>
</html>
